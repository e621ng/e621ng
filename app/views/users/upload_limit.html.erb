<div id="c-users"><div id="a-upload-limit">

  <% pieces = @user.upload_limit_pieces %>
  <% is_current_user = @user.id == CurrentUser.id %>

  <!-- Header -->
  <%= render "/users/partials/show/card", :presenter => @presenter, :user => @user %>

  <!-- Wiki -->
  <div class="profile-container dtext-container">
    <h2>Upload Limit</h2>
    <%= format_text(@page.body, allow_color: true) %>
  </div>

  <!-- Formula -->
  <div class="profile-container">
    <% if @user.can_upload_free? %>
      <p><%= is_current_user ? "You" : link_to_user(@user) %> can upload an <strong>unlimited</strong> number of posts.</p>
    <% else %>
      <p><%= is_current_user ? "You" : link_to_user(@user) %> can currently upload <strong><%= @user.upload_limit %></strong> posts.<br />This limit is based on the following formula:</p>

      <span class="upload-limit-formula">
        <%= @presenter.upload_limit(self) %>
      </span>

      <div class="upload-limit-explanation">
        <div class="ul-num"><%= @user.base_upload_limit %></div>
        <div class="ul-exp">
          <h5>Base Limit</h5>
          <span>Default number of posts that someone with a new account could upload.</span>
        </div>

        <div class="ul-num"><%= pieces[:approved] %></div>
        <div class="ul-exp">
          <h5>Approved</h5>
          <span>Uploaded posts that had been reviewed by a staff member.</span>
        </div>
        
        <div class="ul-num"><%= pieces[:deleted] %></div>
        <div class="ul-exp">
          <h5>Deleted / Replaced / Rejected</h5>
          <span>Uploads that had been rejected, one way or another.</span>
        </div>
        
        <div class="ul-num"><%= pieces[:pending] %></div>
        <div class="ul-exp">
          <h5>Pending / Flagged</h5>
          <span>Posts that are currently awaiting review.</span>
        </div>
        
        <div class="ul-num"><%= @user.upload_limit %></div>
        <div class="ul-exp">
          <h5>Upload Limit</h5>
          <span>Remaining number of posts that can be uploaded.</span>
        </div>
      </div>
    <% end %>
  </div>

  <% if is_current_user %>
    <!-- Throttle -->
    <div class="profile-container">
      <p>
        You are limited to 30 uploads per hour.
      </p>
      <ul>
        <li>Remaining hourly uploads: <%= CurrentUser.hourly_upload_limit %></li>
        <% unless CurrentUser.can_upload_free? || CurrentUser.is_privileged? %>
          <li>Remaining hourly tag edits: <%= CurrentUser.post_edit_limit %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

</div></div>

<%= render "secondary_links" %>

<% content_for(:page_title) do %>
  Upload Limit
<% end %>
